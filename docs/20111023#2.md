# gpart destroyコマンドの挙動を確かめる(2)

2011-10-23作成

※「[http://blogs.yahoo.co.jp/alpha3166/6831641.html gpart destroyコマンドの挙動を確かめる(1)]」からのつづき

では、末尾の64セクタはどう変わったでしょうか。
{{{
# diff -c last64.before last64.after
}}}
あれれ、何も変化がありません。中身を見てみましょう。
{{{
# cat last64.before 
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
00003e00  b6 7c 6e 51 cf 6e d6 11  8f f8 00 02 2d 09 71 2b  |.|nQ.n......-.q+|
00003e10  e0 ed 64 4e 4e fd e0 11  a9 b1 00 1f c6 e3 48 e9  |..dNN.........H.|
00003e20  22 00 00 00 00 00 00 00  0e 60 38 3a 00 00 00 00  |"........`8:....|
00003e30  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
00007e00  45 46 49 20 50 41 52 54  00 00 01 00 5c 00 00 00  |EFI PART....\...|
00007e10  88 fc ae 56 00 00 00 00  2f 60 38 3a 00 00 00 00  |...V..../`8:....|
00007e20  01 00 00 00 00 00 00 00  22 00 00 00 00 00 00 00  |........".......|
00007e30  0e 60 38 3a 00 00 00 00  7d dc 0a 4b 4e fd e0 11  |.`8:....}..KN...|
00007e40  a9 b1 00 1f c6 e3 48 e9  0f 60 38 3a 00 00 00 00  |......H..`8:....|
00007e50  80 00 00 00 80 00 00 00  53 a2 ef d1 00 00 00 00  |........S.......|
00007e60  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
00008000
}}}
3e00～3e2fは、GPTの第1パーティションのエントリーで、7e00～7e5cの92バイトはセカンダリGPTヘッダです。どちらもプライマリGPTと同じ情報が入っています。

セカンダリGPTは、プライマリが損傷したときにヘッダを復旧させるために存在しているようなので、本当にパーティションテーブルを削除したいのであれば、こちらも手動で(ddで)クリアしておいた方がよいかもしれません。

まとめておきましょう。gpart destroy -Fコマンドでは:
・Protective MBRのパーティションテーブルはゼロクリアされる。
・プライマリGPTヘッダはゼロクリアされる。
・プライマリGPTのパーティションエントリーは、そのまま残骸が残る。
・セカンダリGPTは、ヘッダ、パーティションエントリーとも、そのまま残骸が残る。場合によっては手動でクリアした方がよいかも。

※バージョンメモ
・FreeBSD 8.2-RELEASE
